 
<div id="textAttrCfgDiv" title='属性设置'>
	<div> 
		<div class="dyform">
			<div class="post-sign">
				<div class="post-detail">
		<table>
			<tr class="odd">
				<td class="Label">字段编码</td>
				<td class="value"><input type="text"
					name="name" id="name" value="" class="w100"/>  
			</tr>
			<!--3 -->
			<tr class="odd">
				<td class="Label">显示名称</td>
				<td class="value"><input type="text" class="w100" name="displayName"
					id="displayName" value="" /></td>
			</tr>
		
			<!--1 -->
			<tr class="odd">
				<td class="Label">应用于</td>
				<td class="value"><input type="text" class="w100" name="applyTo"
					id="applyTo" value="" /> </td>
			</tr>
			
			<tr >
				<td class="Label">默认值</td>
				<td class="value">
				<div style="position: relative;">
					 <input type="text" value="" name="defaultValue"  id="defaultValue" /> 
					 		<div class="hongdy" style="display: block;">
								<ul class="hongdy_ul">
								<li class="noChose">日期时间</li>
								<li class="isChose">当前日期(2000-01-01)</li>
								<li class="isChose">当前日期(2000年1月1日)</li>
								<li class="isChose">当前日期(2000年)</li>
								<li class="isChose">当前日期(2000年1月)</li>
								<li class="isChose">当前日期(1月1日)</li>
								<li class="isChose">当前日期(星期一)</li>
								<li class="isChose">当前年份(2000)</li>
								<li class="isChose">当前时间(12:00)</li>
								<li class="isChose">当前时间(12:00:00)</li>
								<li class="isChose">当前日期时间(2000-01-01 12:00)</li>
								<li class="isChose">当前日期时间(2000-01-01 12:00:00)</li>
								<li class="noChose">当前用户</li>
								<li class="isChose">当前用户ID</li>
								<li class="isChose">当前用户姓名</li>
								<li class="isChose">当前用户部门(长名称)</li>
								<li class="isChose">当前用户部门(短名称)</li>
								<li class="noChose">创建人</li>
								<li class="isChose">创建人ID</li>
								<li class="isChose">创建人姓名</li>
								<li class="isChose">创建人部门(长名称)</li>
								<li class="isChose">创建人部门(短名称)</li>
								</ul>
								</div>
					</div>
				</td>
			</tr>
		
			<tr class="odd">
				<td class="Label">字段长度</td>
				<td class="value">
					 <input type="text" value="" name="length"  id="length"  /> 
				</td>
			</tr>
		
		
			
				<tr class="odd">
				<td class="Label">文本样式</td>
				<td class="value">	<select name="contentFormat" id="contentFormat" style="display: block;float: left;width: 112px;">
						<option value="10" selected="selected">普通</option>
						<option value="11" >URL</option>
						<option value="12" style="font-size:10px;">EMAIL</option>
						<option value="13" style="font-size:11px;">身份证</option>
						<option value="14" style="font-size:12px;" >电话</option>
						<option value="15" style="font-size:12px;" >手机</option>
					</select></td>
			</tr>
			
					<tr   class="odd">
				<td class="Label">值计算方式</td>
				<td class="value">
					<input type="radio" value="1" name="valueCreateMethod"  id="valueCreateMethod" checked="checked"/><label>用户输入</label>
					<input type="radio" value="3" name="valueCreateMethod"  id="valueCreateMethod" /><label>创建时计算 </label>
					<input type="radio" value="4" name="valueCreateMethod"  id="valueCreateMethod"  /><label>显示时计算 </label>
				</td>
			</tr>
			
			<tr>
				<td class="Label">字体样式</td>
				<td class="value">
				
				<div class="tr_td_div_left">
					<span id="fontcolorElement" class="fontColorCss" ></span>
					<input type="hidden" value="" id="fontColor">
					<div class="subcolorCss" id="subcolor" >
					<div style="display: none;" class="colors">
						<span onclick="selColor('black');" style="background-color:black;" class="selectcolor"></span>
						<span onclick="selColor('red');" style="background-color:red " class="selectcolor"></span>
						<span onclick="selColor('blue');" style="background-color:blue " class="selectcolor"></span>
						<span onclick="selColor('orange');" style="background-color:orange " class="selectcolor"></span>
						<span onclick="selColor('green');" style="background-color:green " class="selectcolor"></span>
						<span onclick="selColor('yellow');" style="background-color:yellow " class="selectcolor"></span>
						<span onclick="selColor('purple');" style="background-color:purple " class="selectcolor"></span>
						<span onclick="selColor('silver');" style="background-color:silver " class="selectcolor"></span>
						<span onclick="selColor('tan');" style="background-color:tan " class="selectcolor"></span>
						<span onclick="selColor('maroon');" style="background-color:maroon;" class="selectcolor"></span>
						<span onclick="selColor('olive');" style="background-color:olive;" class="selectcolor"></span>
						<span onclick="selColor('gray');" style="background-color:gray;" class="selectcolor"></span>
						<span onclick="selColor('lime');" style="background-color:lime;" class="selectcolor"></span>
					</div>
					</div>
				</div>
			 <div class="tr_td_div_left">
					<select name="fontSize" id="fontSize" style="display: block;float: left;width: 112px;">
						
						<option value="8" style="font-size:8px;">8</option>
						<option value="9" style="font-size:9px;">9</option>
						<option value="10" style="font-size:10px;">10</option>
						<option value="11" style="font-size:11px;">11</option>
						<option value="12" style="font-size:12px;" selected="selected">12</option>
						<option value="14" style="font-size:14px;">14</option>
						<option value="16" style="font-size:16px;">16</option>
						<option value="18" style="font-size:18px;">18</option>
						<option value="20" style="font-size:20px;">20</option>
						<option value="22" style="font-size:22px;">22</option>
						<option value="24" style="font-size:24px;">24</option>
						<option value="26" style="font-size:26px;">26</option>
						<option value="28" style="font-size:28px;">28</option>
						<option value="36" style="font-size:36px;">36</option>
						<option value="48" style="font-size:48px;">48</option>
						<option value="72" style="font-size:72px;">72</option>
					</select>
				</div>
				</td>
			</tr>
			
			
			<tr  class="odd">
				<td class="Label">控件样式</td>
				<td class="value">
				 
				<div class="tr_td_div_left">
					<span style="float: left;padding-top: 9px;margin-right: 3px;">宽度:</span><input type="text" name="ctlWidth" id="ctlWidth" style="width: 25px;float: left;"/>
				</div>
				<div class="tr_td_div_left">
					<span style="float: left;padding-top: 9px;margin-right: 3px;">高度:</span><input type="text" name="ctlHight" id="ctlHight" style="width: 25px;float: left;"/>
				</div>
				<div class="tr_td_div_left">
					<select name="textAlign" id="textAlign"  style="width: 100px;">
						<option value="">--对齐方式--</option>
						<option value="center">居中</option>
						<option value="left">靠左</option>
						<option value="right">靠右</option>
					</select>
				</div>
				</td>
			</tr>
 			<tr>
				<td class="Label">编辑模式</td>
				<td class="value"> 
					<div class="tr_td_div_left" style="padding-top: 9px;"> 
				<input type="radio" name="showType" value="1" checked="checked">可编辑
						<input type="radio" name="showType" value="3"> 只读
						<input type="radio" name="showType" value="2">显示文本
						<input type="radio" name="showType" value="4"> 禁用
						<input type="radio" name="showType" value="5"> 隐藏
					</div>
				</td>
			</tr>
			 
			 
			<tr class="odd" >
				<td class="Label">校验规则</td>
				<td class="value">
					<input type="checkbox" name="fieldCheckRules" id="checkRule_1" value="1"  onclick="checkMust(this)"/><label for="checkRule_1">非空</label>  
					<input type="checkbox" name="fieldCheckRules" id="checkRule_5" value="5" onclick="checkUnique(this)"/><label for="checkRule_5">唯一</label></td>
			</tr> 
			
				 
			<tr id="tr_onlyreadUrl" >
				<td class="Label">标识地址</td>
				<td class="value"><input type="text" id="onlyreadUrl" name="onlyreadUrl" /></td>
			</tr> 
			
		
			
		</table>
		
	</div>
	</div>
		</div>
		</div>
	
		</div>


<script type="text/javascript">


var textctl = {};

/**
 * 初始化属性窗口
 */
 textctl.initPropertyDialog = function (editor){
	 $(".cke_reset_all").removeClass("cke_reset_all");//删除ckeditor内部的局css
	this.editor = editor;
	loadCommonJsFile();//加载自定义的ckeditor公共js 
	var focusedDom = editor.focusedDom;//当前editor被双击的对象(CKEDITOR.dom.node类) 
	var field = null;
	if(focusedDom != null && (typeof focusedDom) != "undefined"){
		var fieldName = $(focusedDom).attr("name");
		field = formDefinition.fields[fieldName];//表单中从表的信息 
	}
	this.initProperty(field);
};

textctl.initProperty = function(field){
	if(field == null ||  (typeof field) == "undefined"){
		field = new WTextInputClass();
		field.dbDataType = dyFormInputType.text;
		field.valueCreateMethod = dyFormInputValue.userImport;
	}else{
	}
	$(".hongdy").hide();
	//选择字段值的具体时的响应动作
	$(".isChose").click(function(){
		$("#defaultValue").val($("#defaultValue").val()+"{"+$(this).html()+"}");
	});
	$(document).mousedown(function(event){
		var temp = $(event.target).attr("class");
		if(temp!="noChose"&&temp!="isChose"&&temp!="hongdy"){
			$(".hongdy").hide();
		}
	});
	$("#defaultValue").addClass("input-tier");
	//公共属性
	$.ControlConfigUtil.ctlPropertyComInitSet(field);
	//私有属性设置
	$("#contentFormat").val(field.contentFormat);
	//默认值转换
	$("#defaultValue").val(this.reaplaceInitDefaultValue(field.defaultValue));
	//表单字段值获得焦点时下拉宏一定选项
	$("#defaultValue").focus(function(){
			$(".hongdy").show();
	});
	$("input[name='valueCreateMethod'][value='" + field.valueCreateMethod + "']").each(function(){
		this.checked = true;
	});
	
}


textctl.exitDialog = function(){
	this.editor.focusedDom = null;
}

textctl.collectFormAndFillCkeditor = function(){ 
	var field = new WTextInputClass();

	//控件公共属性收集
	var checkpass=$.ControlConfigUtil.collectFormCtlComProperty(field);
	if(!checkpass){
		return false;
	}
	//默认值转换
	field.defaultValue=this.reaplaceDefaultValue($("#defaultValue").val());
	//特殊属性收集
	field.contentFormat=$("#contentFormat").val();
	field.valueCreateMethod = $("input[name='valueCreateMethod']:checked").val();
	field.inputMode =  dyFormInputMode.text;
	field.fieldCheckRules.push({value:field.contentFormat, label:$("#contentFormat").find("option:selected").text()});
	
	var ctlHtml = "<img  class='value' name='" + field.name + "' title='" + field.displayName +"' src='" + this.editor.imageOfTextctl + "'/>";
	$(this.editor.fieldClazzElement).attr("class", "field");
	var element = CKEDITOR.dom.element.createFromHtml( ctlHtml );
	if(this.editor.focusedDom != null){
		element.insertBefore(this.editor.focusedDom);
		this.editor.focusedDom.remove(); 
	}else{
		this.editor.insertElement( element );
	}
	formDefinition.fields[field.name] = field; 
	
	return true;
}

textctl.reaplaceInitDefaultValue=function(initdefaultvalue){
	var tempStr=initdefaultvalue;
	tempStr = tempStr.replace(dySysVariable.currentYearMonthDate,"{当前日期(2000-01-01)}" );
	tempStr = tempStr.replace(dySysVariable.currentYearMonthDateCn,"{当前日期(2000年1月1日)}" );
	tempStr = tempStr.replace(dySysVariable.currentYearCn,"{当前日期(2000年)}");
	tempStr = tempStr.replace(dySysVariable.currentYearMonthCn,"{当前日期(2000年1月)}" );
	tempStr = tempStr.replace(dySysVariable.currentMonthDateCn,"{当前日期(1月1日)}" );
	tempStr = tempStr.replace(dySysVariable.currentWeekCn,"{当前日期(星期一)}" );
	tempStr = tempStr.replace(dySysVariable.currentYear,"{当前年份(2000)}" );
	tempStr = tempStr.replace(dySysVariable.currentTimeMin,"{当前时间(12:00)}" );
	tempStr = tempStr.replace(dySysVariable.currentTimeSec,"{当前时间(12:00:00)}" );
	tempStr = tempStr.replace(dySysVariable.currentDateTimeMin,"{当前日期时间(2000-01-01 12:00)}");
	tempStr = tempStr.replace(dySysVariable.currentDateTimeSec,"{当前日期时间(2000-01-01 12:00:00)}");
	tempStr = tempStr.replace(dySysVariable.currentUserId,"{当前用户ID}" );
	tempStr = tempStr.replace(dySysVariable.currentUserName,"{当前用户姓名}" );
	tempStr = tempStr.replace(dySysVariable.currentUserDepartmentPath,"{当前用户部门(长名称)}");
	tempStr = tempStr.replace(dySysVariable.currentUserDepartmentName,"{当前用户部门(短名称)}");
	tempStr = tempStr.replace(dySysVariable.currentCreatorId,"{创建人ID}" );
	tempStr = tempStr.replace(dySysVariable.currentCreatorName,"{创建人姓名}" );
	tempStr = tempStr.replace(dySysVariable.currentCreatorDepartmentPath,"{创建人部门(长名称)}");
	tempStr = tempStr.replace(dySysVariable.currentCreatorDepartmentName,"{创建人部门(短名称)}");
	return tempStr;
}

textctl.reaplaceDefaultValue=function(defaultvalue){
	var tempStr=defaultvalue;
	tempStr = tempStr.replace("{当前日期(2000-01-01)}", dySysVariable.currentYearMonthDate);
	tempStr = tempStr.replace("{当前日期(2000年1月1日)}", dySysVariable.currentYearMonthDateCn);
	tempStr = tempStr.replace("{当前日期(2000年)}", dySysVariable.currentYearCn);
	tempStr = tempStr.replace("{当前日期(2000年1月)}", dySysVariable.currentYearMonthCn);
	tempStr = tempStr.replace("{当前日期(1月1日)}", dySysVariable.currentMonthDateCn);
	tempStr = tempStr.replace("{当前日期(星期一)}", dySysVariable.currentWeekCn);
	tempStr = tempStr.replace("{当前年份(2000)}", dySysVariable.currentYear);
	tempStr = tempStr.replace("{当前时间(12:00)}", dySysVariable.currentTimeMin);
	tempStr = tempStr.replace("{当前时间(12:00:00)}", dySysVariable.currentTimeSec);
	tempStr = tempStr.replace("{当前日期时间(2000-01-01 12:00)}",dySysVariable.currentDateTimeMin);
	tempStr = tempStr.replace("{当前日期时间(2000-01-01 12:00:00)}", dySysVariable.currentDateTimeSec);
	tempStr = tempStr.replace("{当前用户ID}", dySysVariable.currentUserId);
	tempStr = tempStr.replace("{当前用户姓名}", dySysVariable.currentUserName);
	tempStr = tempStr.replace("{当前用户部门(长名称)}",dySysVariable.currentUserDepartmentPath);
	tempStr = tempStr.replace("{当前用户部门(短名称)}",dySysVariable.currentUserDepartmentName);
	tempStr = tempStr.replace("{创建人ID}", dySysVariable.currentCreatorId);
	tempStr = tempStr.replace("{创建人姓名}", dySysVariable.currentCreatorName);
	tempStr = tempStr.replace("{创建人部门(长名称)}",dySysVariable.currentCreatorDepartmentPath);
	tempStr = tempStr.replace("{创建人部门(短名称)}",dySysVariable.currentCreatorDepartmentName);
	return tempStr;
}



</script>