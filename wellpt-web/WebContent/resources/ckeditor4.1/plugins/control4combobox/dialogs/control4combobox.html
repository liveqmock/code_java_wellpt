 
<div id="comboboxAttrCfgDiv" title='属性设置'>
	<div> 
		<div class="dyform">
			<div class="post-sign">
				<div class="post-detail">
		<table>
			<tr class="odd">
				<td class="Label">字段编码</td>
				<td class="value"><input type="text"
					name="name" id="name" value="" class="w100"/>  
			</tr>
			<!--3 -->
			<tr >
				<td class="Label">显示名称</td>
				<td class="value"><input type="text" class="w100" name="displayName"
					id="displayName" value="" /></td>
			</tr>
		
			<!--1 -->
			<tr class="odd">
				<td class="Label">应用于</td>
				<td class="value"><input type="text" class="w100" name="applyTo"
					id="applyTo" value="" /> </td>
			</tr>
			
			<tr >
				<td class="Label">默认值</td>
				<td class="value">
					 <input type="text" value="" name="defaultValue"  id="defaultValue" /> 
				</td>
			</tr>
			
				<tr class="odd">
				<td class="Label">字段长度</td>
				<td class="value">
					 <input type="text"  name="length"  id="length"  /> 
				</td>
			</tr>
			
			<tr>
				<td class="Label">备选项来源</td>
				<td class="value">
				<input id="optionDataSource_1" type="radio" value="1" name="optionDataSource">
				<label for="optionDataSource_1">常量</label>
				<input id="optionDataSource_2" type="radio" value="2" name="optionDataSource" checked="checked">
				<label for="optionDataSource_2">取字典</label>
				</td>
			</tr>
				
			<tr id='tr_data' hide="true">
				<td  class="Label">备选项设置</td>
				<td class="value"><input type="text" id="optdata" name="optdata" value=""/></td>
			</tr> 	
				
			<tr id='tr_dicCode'>
				<td  class="Label">字典编码</td>
				<td class="value">
				<input id="dictName" class="w100" type="text" value="--请选择--" name="dictName">
				<input id="dictCode" type="hidden" class="w100" type="text"  name="dictCode">
				
				
				<ul id="datadict_tree" class="ztree"></ul>
				</td>
			</tr>
				
			
			
			<tr>
				<td class="Label">字体样式</td>
				<td class="value">
				
				<div class="tr_td_div_left">
					<span id="fontcolorElement" class="fontColorCss" ></span>
					<input type="hidden" value="" id="fontColor">
					<div class="subcolorCss" id="subcolor" >
					<div style="display: none;" class="colors">
						<span onclick="selColor('black');" style="background-color:black;" class="selectcolor"></span>
						<span onclick="selColor('red');" style="background-color:red " class="selectcolor"></span>
						<span onclick="selColor('blue');" style="background-color:blue " class="selectcolor"></span>
						<span onclick="selColor('orange');" style="background-color:orange " class="selectcolor"></span>
						<span onclick="selColor('green');" style="background-color:green " class="selectcolor"></span>
						<span onclick="selColor('yellow');" style="background-color:yellow " class="selectcolor"></span>
						<span onclick="selColor('purple');" style="background-color:purple " class="selectcolor"></span>
						<span onclick="selColor('silver');" style="background-color:silver " class="selectcolor"></span>
						<span onclick="selColor('tan');" style="background-color:tan " class="selectcolor"></span>
						<span onclick="selColor('maroon');" style="background-color:maroon;" class="selectcolor"></span>
						<span onclick="selColor('olive');" style="background-color:olive;" class="selectcolor"></span>
						<span onclick="selColor('gray');" style="background-color:gray;" class="selectcolor"></span>
						<span onclick="selColor('lime');" style="background-color:lime;" class="selectcolor"></span>
					</div>
					</div>
				</div>
			 <div class="tr_td_div_left">
					<select name="fontSize" id="fontSize" style="display: block;float: left;width: 112px;">
						
						<option value="8" style="font-size:8px;">8</option>
						<option value="9" style="font-size:9px;">9</option>
						<option value="10" style="font-size:10px;">10</option>
						<option value="11" style="font-size:11px;">11</option>
						<option value="12" style="font-size:12px;" selected="selected">12</option>
						<option value="14" style="font-size:14px;">14</option>
						<option value="16" style="font-size:16px;">16</option>
						<option value="18" style="font-size:18px;">18</option>
						<option value="20" style="font-size:20px;">20</option>
						<option value="22" style="font-size:22px;">22</option>
						<option value="24" style="font-size:24px;">24</option>
						<option value="26" style="font-size:26px;">26</option>
						<option value="28" style="font-size:28px;">28</option>
						<option value="36" style="font-size:36px;">36</option>
						<option value="48" style="font-size:48px;">48</option>
						<option value="72" style="font-size:72px;">72</option>
					</select>
				</div>
				</td>
			</tr>
			
			
			<tr  class="odd">
				<td class="Label">控件样式</td>
				<td class="value">
				 
				<div class="tr_td_div_left">
					<span style="float: left;padding-top: 9px;margin-right: 3px;">宽度:</span><input type="text" name="ctlWidth" id="ctlWidth" style="width: 25px;float: left;"/>
				</div>
				<div class="tr_td_div_left">
					<span style="float: left;padding-top: 9px;margin-right: 3px;">高度:</span><input type="text" name="ctlHight" id="ctlHight" style="width: 25px;float: left;"/>
				</div>
				<div class="tr_td_div_left">
					<select name="textAlign" id="textAlign"  style="width: 100px;">
						<option value="">--对齐方式--</option>
						<option value="center">居中</option>
						<option value="left">靠左</option>
						<option value="right">靠右</option>
					</select>
				</div>
				</td>
			</tr>
 			<tr> 
 			
				<td class="Label">编辑模式</td>
				<td class="value"> 
					<div class="tr_td_div_left" style="padding-top: 9px;"> 
						<input type="radio" name="showType" value="1" checked="checked">可编辑
						<input type="radio" name="showType" value="2">显示文本
						<input type="radio" name="showType" value="4"> 禁用
						<input type="radio" name="showType" value="5"> 隐藏
					</div>
				</td>
			</tr>
			 
			<tr class="odd" >
				<td class="Label">校验规则</td>
				<td class="value">
					<input type="checkbox" name="fieldCheckRules" id="checkRule_1" value="1"  onclick="checkMust(this)"/><label for="checkRule_1">非空</label>  
					<input type="checkbox" name="fieldCheckRules" id="checkRule_5" value="5" onclick="checkUnique(this)"/><label for="checkRule_5">唯一</label></td>
			</tr> 
			
				 
		<!-- 	<tr>
				<td class="Label">标识地址</td>
				<td class="value"><input type="text" id="onlyreadUrl" name="onlyreadUrl" /></td>
			</tr>  -->
			
		
			
		</table>
		
	</div>
	</div>
		</div>
		</div>
</div>
<script type="text/javascript">
var comboboxctl = {};

/**
 * 初始化属性窗口
 */
 comboboxctl.initPropertyDialog = function (editor){
	 $(".cke_reset_all").removeClass("cke_reset_all");//删除ckeditor内部的局css
	this.editor = editor;
	loadCommonJsFile();//加载自定义的ckeditor公共js 
	var focusedDom = editor.focusedDom;//当前editor被双击的对象(CKEDITOR.dom.node类) 
	var field = null;
	if(focusedDom != null && (typeof focusedDom) != "undefined"){
		var fieldName = $(focusedDom).attr("name");
		field = formDefinition.fields[fieldName];//表单中从表的信息 
	}
	this.initProperty(field);
};

comboboxctl.initProperty = function(field){
	//初始化数据字典树.
	$.ControlConfigUtil.initDictCode();
	 $("input[name='optionDataSource']").change(
			 function(){
				 var checkvalue=$("input[name='optionDataSource']:checked").val();
				 if(checkvalue=='1'){
					 $('#tr_dicCode').hide();
					 $('#tr_data').show();
					 $("input[name='dictCode']").val();
					 $("input[name='dictName']").val();
				 }else{
					 $("#tr_dicCode").show();
					 $("#tr_data").hide();
					 $("#optdata").val();
				 }
			 }
		 );
	
	if(field == null ||  (typeof field) == "undefined"){
		field = new MainFormFieldClass();
		field.dbDataType = dyFormInputType.selectMutilFase;
		field.valueCreateMethod = "1";
		 
	}else{
		//$("#name").attr("readonly", "readonly");//在编辑的状态下时则时字段名为只读
	}
	//控件属性初始化公共设置.
	$.ControlConfigUtil.ctlPropertyComInitSet(field);
	
	//私有属性
	if(field.optionDataSource=='2'){
		$("input[name='optionDataSource'][value='"+2+"']").attr("checked",true);
		$('#tr_dicCode').show();
		 $('#tr_data').hide();
	}else if(field.optionDataSource=='1'){
		$("input[name='optionDataSource'][value='"+1+"']").attr("checked",true);
		$('#tr_dicCode').hide();
		$('#tr_data').show();
		
	}else{
		 $('#tr_data').hide();
	}
	
	if(field.dictCode!=""&&field.dictCode!=undefined){
		$("#dictCode").val(field.dictCode);
		var dictcodearray=field.dictCode.split(":");
		$("#dictName").val(dictcodearray[1]);
	}
	
	if(JSON.stringify(field.optionSet)!='[]'){
		$("#optdata").val(JSON.stringify(field.optionSet));
	}
}


comboboxctl.exitDialog = function(){
	this.editor.focusedDom = null;
}

comboboxctl.collectFormAndFillCkeditor = function(){ 
	var field = new MainFormFieldClass();
	field.inputMode =  dyFormInputMode.selectMutilFase;

	field.optionDataSource=$("input[name='optionDataSource']:checked").val();
	//控件公共属性收集
	var checkpass=$.ControlConfigUtil.collectFormCtlComProperty(field);
	if(!checkpass){
		return false;
	}
	if(field.optionDataSource=='1'){
		if($("#optdata").val()==""||$("#optdata").val()==undefined){
			alert("备选项设置不能为空！");
			return false;
		}
		field.optionSet=eval("("+$("#optdata").val()+")");
	}else{
		 if($("#dictName").val()==""||$("#dictName").val()==undefined){
			alert("字典编码不能为空！");
			return false;
		} 
		field.dictCode= $("#dictCode").val();
	}
	
	
	
	var ctlHtml = "<img  class='value' name='" + field.name + "' title='" + field.displayName +"' src='" + this.editor.imageOfComboBoxctl + "'/>";
	$(this.editor.fieldClazzElement).attr("class", "field");
	var element = CKEDITOR.dom.element.createFromHtml( ctlHtml );
	if(this.editor.focusedDom != null){
		element.insertBefore(this.editor.focusedDom);
		this.editor.focusedDom.remove(); 
	}else{
		this.editor.insertElement( element );
	}
	formDefinition.fields[field.name] = field; 
	return true;
	
}


</script>