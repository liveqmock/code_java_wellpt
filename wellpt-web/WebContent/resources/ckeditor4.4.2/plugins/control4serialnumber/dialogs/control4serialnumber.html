 
<div id="snAttrCfgDiv" title='属性设置'  style=" height: 400px; overflow: auto;">
	<div> 
		<div class="dyform">
			<div class="post-sign">
				<div class="post-detail">
		<table>
			<tr class="odd">
				<td class="Label">字段编码</td>
				<td class="value"><input type="text"
					name="name" id="name" value="" class="w100"/>  
			</tr>
			<!--3 -->
			<tr class="odd">
				<td class="Label">显示名称</td>
				<td class="value"><input type="text" class="w100" name="displayName"
					id="displayName" value="" /></td>
			</tr>
		
			<!--1 -->
			<tr class="odd">
				<td class="Label">应用于</td>
				<td class="value"><input type="text" class="w100" name="applyTo"
					id="applyTo" value="" /> </td>
			</tr>
			
		<!-- 	<tr >
				<td class="Label">默认值</td>
				<td class="value">
					 <input type="text" value="" name="defaultValue"  id="defaultValue" /> 
				</td>
			</tr> -->
			
			<tr >
				<td class="Label">流水号属性</td>
				<td class="value"> 
					<div class="tr_td_div_left" style="padding-top: 9px;"> 
				<input type="radio" name="inputMode" value="7" checked="checked">可编辑
				<input type="radio" name="inputMode" value="29"> 自动生成
					</div>
				</td>
			</tr> 
		
			<tr class="odd">
				<td class="Label">流水号ID</td>
				<td class="value">
					<select id="designatedId" name="designatedId">
				</td>
			</tr>
		
		
		<tr id="tr_designatedType" class="odd">
				<td class="Label">流水号分类</td>
				<td class="value">
					<select id="designatedType" name="designatedType">
					</td>
			</tr>
			
			<tr id="tr_isOverride" class="odd">
				<td class="Label">覆盖指针</td>
				<td class="value">
					<select id="isOverride" name="isOverride">
				<option value="0">不覆盖</option>
				<option value="1">新指针大于当前指针才覆盖</option>
				<option value="2">覆盖</option>
					</td>
			</tr>
			
				<tr id="tr_isSaveDb" class="odd">
				<td class="Label">保存数据库</td>
				<td class="value">
					<select id="isSaveDb" name="isSaveDb">
				<option value="0">是</option>
				<option value="1">否</option>
					</td>
			</tr>
			
			<tr>
				<td class="Label">字体样式</td>
				<td class="value">
				
				<div class="tr_td_div_left">
					<span id="fontcolorElement" class="fontColorCss" ></span>
					<input type="hidden" value="" id="fontColor">
					<div class="subcolorCss" id="subcolor" >
					<div style="display: none;" class="colors">
						<span onclick="selColor('black');" style="background-color:black;" class="selectcolor"></span>
						<span onclick="selColor('red');" style="background-color:red " class="selectcolor"></span>
						<span onclick="selColor('blue');" style="background-color:blue " class="selectcolor"></span>
						<span onclick="selColor('orange');" style="background-color:orange " class="selectcolor"></span>
						<span onclick="selColor('green');" style="background-color:green " class="selectcolor"></span>
						<span onclick="selColor('yellow');" style="background-color:yellow " class="selectcolor"></span>
						<span onclick="selColor('purple');" style="background-color:purple " class="selectcolor"></span>
						<span onclick="selColor('silver');" style="background-color:silver " class="selectcolor"></span>
						<span onclick="selColor('tan');" style="background-color:tan " class="selectcolor"></span>
						<span onclick="selColor('maroon');" style="background-color:maroon;" class="selectcolor"></span>
						<span onclick="selColor('olive');" style="background-color:olive;" class="selectcolor"></span>
						<span onclick="selColor('gray');" style="background-color:gray;" class="selectcolor"></span>
						<span onclick="selColor('lime');" style="background-color:lime;" class="selectcolor"></span>
					</div>
					</div>
				</div>
			 <div class="tr_td_div_left">
					<select name="fontSize" id="fontSize" style="display: block;float: left;width: 112px;">
						
						<option value="8" style="font-size:8px;">8</option>
						<option value="9" style="font-size:9px;">9</option>
						<option value="10" style="font-size:10px;">10</option>
						<option value="11" style="font-size:11px;">11</option>
						<option value="12" style="font-size:12px;" selected="selected">12</option>
						<option value="14" style="font-size:14px;">14</option>
						<option value="16" style="font-size:16px;">16</option>
						<option value="18" style="font-size:18px;">18</option>
						<option value="20" style="font-size:20px;">20</option>
						<option value="22" style="font-size:22px;">22</option>
						<option value="24" style="font-size:24px;">24</option>
						<option value="26" style="font-size:26px;">26</option>
						<option value="28" style="font-size:28px;">28</option>
						<option value="36" style="font-size:36px;">36</option>
						<option value="48" style="font-size:48px;">48</option>
						<option value="72" style="font-size:72px;">72</option>
					</select>
				</div>
				</td>
			</tr>
			
			
			<tr  class="odd">
				<td class="Label">控件样式</td>
				<td class="value">
				 
				<div class="tr_td_div_left">
					<span style="float: left;padding-top: 9px;margin-right: 3px;">宽度:</span><input type="text" name="ctlWidth" id="ctlWidth" style="width: 25px;float: left;"/>
				</div>
				<div class="tr_td_div_left">
					<span style="float: left;padding-top: 9px;margin-right: 3px;">高度:</span><input type="text" name="ctlHight" id="ctlHight" style="width: 25px;float: left;"/>
				</div>
				<div class="tr_td_div_left">
					<select name="textAlign" id="textAlign"  style="width: 100px;">
						<option value="">--对齐方式--</option>
						<option value="center">居中</option>
						<option value="left">靠左</option>
						<option value="right">靠右</option>
					</select>
				</div>
				</td>
			</tr>
 			<tr>
				<td class="Label">编辑模式</td>
				<td class="value"> 
					<div class="tr_td_div_left" style="padding-top: 9px;"> 
				<input type="radio" name="showType" value="1" checked="checked">可编辑
						<input type="radio" name="showType" value="3"> 只读
						<input type="radio" name="showType" value="2">显示文本
						<input type="radio" name="showType" value="4"> 禁用
						<input type="radio" name="showType" value="5"> 隐藏
					</div>
				</td>
			</tr>
			 
			 
			<tr class="odd" >
				<td class="Label">校验规则</td>
				<td class="value">
					<input type="checkbox" name="fieldCheckRules" id="checkRule_1" value="1"  onclick="checkMust(this)"/><label for="checkRule_1">非空</label>  
					<input type="checkbox" name="fieldCheckRules" id="checkRule_5" value="5" onclick="checkUnique(this)"/><label for="checkRule_5">唯一</label></td>
			</tr> 
			
				 
			<tr id="tr_onlyreadUrl" >
				<td class="Label">标识地址</td>
				<td class="value"><input type="text" id="onlyreadUrl" name="onlyreadUrl" /></td>
			</tr> 
			
		
			
		</table>
		
	</div>
	</div>
		</div>
		</div>
</div>
<script type="text/javascript">


var serialnumberctl = {};
serialnumberctl.$ =  function(selector){ 
	return $(selector, $("#snAttrCfgDiv"));
} 

$.extend(serialnumberctl, $.ControlConfigUtil);
/**
 * 初始化属性窗口
 */
 serialnumberctl.initPropertyDialog = function (editor){
	 $(".cke_reset_all").removeClass("cke_reset_all");//删除ckeditor内部的局css
	this.editor = editor;
	//loadCommonJsFile();//加载自定义的ckeditor公共js 
	var focusedDom = editor.focusedDom;//当前editor被双击的对象(CKEDITOR.dom.node类) 
	
	//初始化应用于
	this.initApplyToTree($("#applyTo"));

	
	var field = null;
	if(focusedDom != null && (typeof focusedDom) != "undefined"){
		var fieldName = $(focusedDom).attr("name");
		 
		field = formDefinition.fields[fieldName];//表单中从表的信息 
		console.log("formDefinition变量获取:"+formDefinition.fields[field.name].name);
	}
	
	this.initProperty(field);
	
};

serialnumberctl.initProperty = function(field){
	if(field == null ||  (typeof field) == "undefined"){
		field = new WSerialNumberClass();
		field.dbDataType = dyFormInputType.textArea;
		field.valueCreateMethod = "1";
	}else{
	}
	
	//控件属性初始化公共设置.
	this.ctlPropertyComInitSet(field);
	
	//私有属性设置
    $('#isOverride').find('option[value=' + field.isOverride + ']').attr('selected',true);
    $('#isSaveDb').find('option[value=' + field.isSaveDb + ']').attr('selected',true);
	$("input[name='inputMode'][value='"+field.inputMode+"']").attr("checked",true);
	$("#defaultValue").val(field.defaultValue);
	$("#onlyreadUrl").val(field.onlyreadUrl); 
	
	//设置约束条件
	if((typeof field.fieldCheckRules) != "undefined" 
			&& field.fieldCheckRules != null){
		var fieldCheckRules =  field.fieldCheckRules;
		for(var i = 0; i < fieldCheckRules.length ; i++){
			var fieldCheckRule = fieldCheckRules[i];
			$("input[name='fieldCheckRules'][value='" + fieldCheckRule.value + "']").each(function(){
				this.checked = true;
			});
		}
	}
	
	initDesignatedSelect(field);
	
	 $("input[name='inputMode']").change(function(){
		var value=$("input[name='inputMode']:checked").val();
			if(value==dyFormInputMode.unEditSerialNumber){
				$("#tr_isOverride").hide();
				$("#tr_designatedType").hide();
				$("#tr_isSaveDb").show();
				 $("input[name='showType'][value='1']").attr("disabled","disabled");
				 $("input[name='showType'][value='3']").attr("disabled","disabled");
				 $("input[name='showType'][value='4']").attr("disabled","disabled");
				 $("input[name='showType'][value='2']").prop("checked","true");
			}else{
				$("#tr_isOverride").show();
				$("#tr_designatedType").show();
				$("#tr_isSaveDb").hide();
				 $("input[name='showType'][value='1']").removeAttr("disabled");
				 $("input[name='showType'][value='3']").removeAttr("disabled");
				 $("input[name='showType'][value='4']").removeAttr("disabled");
				 $("input[name='showType'][value='1']").prop("checked","true");
			}
	});
	
		if(field.inputMode==dyFormInputMode.unEditSerialNumber){
			$("#tr_isOverride").hide();
			$("#tr_designatedType").hide();
			$("#tr_isSaveDb").show();
			 $("input[name='showType'][value='1']").attr("disabled","disabled");
			 $("input[name='showType'][value='3']").attr("disabled","disabled");
			 $("input[name='showType'][value='4']").attr("disabled","disabled");
		}else{
			$("#tr_isOverride").show();
			$("#tr_designatedType").show();
			$("#tr_isSaveDb").hide();
			 $("input[name='showType'][value='1']").removeAttr("disabled");
			 $("input[name='showType'][value='3']").removeAttr("disabled");
			 $("input[name='showType'][value='4']").removeAttr("disabled");
		}
	
}


serialnumberctl.exitDialog = function(){
	this.editor.focusedDom = null;
}

serialnumberctl.collectFormAndFillCkeditor = function(){ 
	var field = new WSerialNumberClass();
	

	//控件公共属性收集
	var checkpass=this.collectFormCtlComProperty(field);
	if(!checkpass){
		return false;
	}
	
	field.applyTo=$("#applyTo").wcomboTree("getObject").getValue();
	field.inputMode = $("input[name='inputMode']:checked").val();
	
	field.designatedId=$("#designatedId").val();
	if(field.inputMode==dyFormInputMode.serialNumber){
		field.designatedType=$("#designatedType").val();
		field.isOverride=$("#isOverride").val();
	}else if(field.inputMode==dyFormInputMode.unEditSerialNumber){
		field.isSaveDb=$("#isSaveDb").val();
	}
	
	if(field.showType==''||field.showType==undefined){
		alert('请选择编辑模式!');
		return false;
	}
	//创建控件占位符
	this.createControlPlaceHolder(this,this.editor.imageOfSerialNumberctl,field);

	formDefinition.fields[field.name] = field; 
	
	return true;
}

	/**
	 * 初始化流水号下拉选项
	 */
	function initDesignatedSelect(field){
		 $.ajax({
	         url: contextPath + '/dytable/list/getSerialNumberIdList.action',
	         type: "post",
	         dataType: "json",
	         success: function (result) {
	         	$("#designatedId").append("<option value='请选择'>请选择</option>");
	             $.each(result, function (key, data) {
	                 $("#designatedId").append("<option value=" + data + ">" + data + "</option>");
	             });
	            	 $('#designatedId').find('option[value='+ field.designatedId +']').attr('selected',true);
	         }
	     });
		  
		  $.ajax({
	         url: contextPath + '/dytable/list/getSerialNumberTypeList.action',
	         type: "post",
	         dataType: "json",
	         success: function (result) {
	         	$("#designatedType").append("<option value='请选择'>请选择</option>");
	             $.each(result, function (key, data) {
	                 $("#designatedType").append("<option value=" + data + ">" + data + "</option>");
	             });
	            	  $('#designatedType').find('option[value=' + field.designatedType + ']').attr('selected',true);
	             }
	     });
	}



</script>