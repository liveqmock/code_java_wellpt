function getMenuRow(s_Disabled,s_Event,s_Image,s_Html,s_SubID,i_Order,i_Index){var s_MouseOver=" onMouseOver=\"this.children[0].className='MouseOver';this.children[1].className='MouseOver';this.children[2].className='MouseOver';";var s_MouseOut=" onMouseOut=\"this.children[0].className='LeftBg';this.children[1].className='CenterBg';this.children[2].className='RightBg';\"";var s_MenuRow="";if(i_Order==1){s_MouseOver+="parent.oPopupSubMenu.hide();parent.oPopupThirdMenu.hide();";if(s_SubID!=""){s_MouseOver+="document.all('ID_Click_"+i_Index+"').click();";}}else{if(i_Order==2){s_MouseOver+="parent.parent.oPopupThirdMenu.hide();";if(s_SubID!=""){s_MouseOver+="document.all('ID_Click_"+i_Index+"').click();";}}}s_MouseOver+='" ';var s_OnClick="";if(s_Disabled==""){if(s_Event!=""){if(i_Order==1){s_OnClick=' onclick="parent.'+s_Event+';parent.oPopupMenu.hide();parent.oPopupSubMenu.hide();parent.oPopupThirdMenu.hide();"';}else{if(i_Order==2){s_OnClick=' onclick="parent.parent.'+s_Event+';parent.parent.oPopupMenu.hide();parent.parent.oPopupSubMenu.hide();parent.parent.oPopupThirdMenu.hide();"';}else{if(i_Order==3){s_OnClick=' onclick="parent.parent.parent.'+s_Event+';parent.parent.parent.oPopupMenu.hide();parent.parent.parent.oPopupSubMenu.hide();parent.parent.parent.oPopupThirdMenu.hide();"';}}}}else{if(s_SubID!=""){s_OnClick=' onclick="this.onmouseover();"';}}}s_MenuRow+="<tr "+s_MouseOver+s_MouseOut+s_OnClick+">";s_MenuRow+="<td "+s_Disabled+" class=LeftBg nowrap width=22 align=center>";if(s_Image!=""&&s_Image!=null){s_MenuRow+="<img src='./images/"+s_Image+"' border=0>";}s_MenuRow+="</td>";s_MenuRow+="<td "+s_Disabled+" class=CenterBg nowrap valign=middle height=20>&nbsp;&nbsp;"+s_Html+"</td>";s_MenuRow+="<td "+s_Disabled+" class=RightBg width=6>";if(s_SubID!=""){s_MenuRow+="<img src='./images/ico_Menu_Arrow.gif' border=0><input id='ID_Click_"+i_Index+"'"+s_Disabled+' type=button onclick="';if(i_Order==1){s_MenuRow+="parent.showSubMenu('"+s_SubID+"',getTopPosi());";}else{if(i_Order==2){s_MenuRow+="parent.parent.showThirdMenu('"+s_SubID+"',getTopPosi());";}}s_MenuRow+="event.cancelBubble=true;\" style='display:none'>";}s_MenuRow+="</td>";s_MenuRow+="</tr>";return s_MenuRow;}function iGetFontLength(poMenus,piWidth){var liFontLength=110,liFontSize=5;if(poMenus==null){return piWidth;}for(var i=0;i<poMenus.length;i++){if(poMenus[i].imgName=="HR"&&poMenus[i].lineName!=null&&poMenus[i].lineName!=""&&poMenus[i].lineName.length>liFontSize){liFontLength+=(poMenus[i].lineName.length-liFontSize)*16;liFontSize=poMenus[i].lineName.length;}else{if(poMenus[i].imgName!="HR"&&poMenus[i].innerText.length>liFontSize){liFontLength+=(poMenus[i].innerText.length-liFontSize)*16;liFontSize=poMenus[i].innerText.length;}}}return(liFontLength>piWidth)?liFontLength:piWidth;}var oPopupMenu=window.createPopup();var oPopupSubMenu=oPopupMenu.document.parentWindow.createPopup();var oPopupThirdMenu=oPopupSubMenu.document.parentWindow.createPopup();function showMenu(name,width,iframe,pbRightClick){var sMenuHr="<tr><td class=LeftBg nowrap width=22></td><td align=center height={LINEHEIGHT} colspan=2 class=MouseOut><TABLE border=0 cellpadding=0 cellspacing=0 width=98% height={LINEHEIGHT}><tr><td width=50% valign=middle>{LINE}</td><td nowrap disabled valign=middle>{NAME}</td><td width=50% valign=middle>{LINE}</td></tr></TABLE></td></tr>";var sLine="<TABLE border=0 cellpadding=0 cellspacing=0 width=100% height=2><tr><td height=1 class=HrShadow></td></tr><tr><td height=1 class=HrHighLight></td></tr></TABLE>";var sScrollDiv1='<script>var goTime=null;function UpDown(arrow,auto){if(arrow=="up"){document.all.menuDiv.scrollTop -=20;}else if(arrow=="down"){document.all.menuDiv.scrollTop +=20;} if(auto==true){goTime = setTimeout("UpDown(\'"+arrow+"\',true);", 150);}}<\/script>';sScrollDiv1+='<table cellpadding=0 cellspacing=0 class=Menu style="width:100%;height:100%">';sScrollDiv1+='<tr><td height=10 align=center class=MouseOut style="CURSOR: hand" onDblClick="UpDown(\'up\',false);" onMouseDown="UpDown(\'up\',true);" onMouseUp="clearTimeout(goTime);"><font style=\'font-family:Webdings\'>5</font></td></tr>';sScrollDiv1+='<tr><td style="vertical-align:top;">';sScrollDiv1+='<div id=menuDiv style="position:absolute;width:100%;height:100%;overflow-x:hidden;overflow-y:hidden;border:0px solid #000000;clip:rect();">';var sScrollDiv2="</div></td></tr>";sScrollDiv2+='<tr><td height=10 align=center class=MouseOut style="CURSOR: hand" onDblClick="UpDown(\'down\',false);" onMouseDown="UpDown(\'down\',true);" onMouseUp="clearTimeout(goTime);"><font style=\'font-family:Webdings\'>6</font></td></tr></table>';var oPopDocument=oPopupMenu.document;var oPopBody=oPopupMenu.document.body;width=(width==null)?150:width;var initWidth=width;var height=0;if(iframe==null){iframe="window";}else{if(iframe=="top.ContentBody"){iframe="window.ContentBody";}else{if(iframe=="top.ViewIFrame"){iframe="window.ViewIFrame";}}}var lodoc=eval(iframe+".document");var sMenu="";var s_Disabled="";var s_SubID="";var s_event="";var liLine=1,liLineHeight=0,lsLine="",lsLineName="";var oMenus=lodoc.getElementsByName(name);if(oMenus!=null){width=iGetFontLength(oMenus,initWidth);for(var i=0;i<oMenus.length;i++){if(oMenus[i].imgName!="HR"){if(oMenus[i].subMenuID!=null&&oMenus[i].subMenuID!=""){s_SubID=oMenus[i].subMenuID;}else{s_SubID="";}s_event="";if(oMenus[i].onclick!=null){s_event=iframe+".document.getElementsByName('"+name+"')["+i+"].click()";}s_Disabled="";if(oMenus[i].disabled==true){s_Disabled="disabled";}sMenu+=getMenuRow(s_Disabled,s_event,oMenus[i].imgName,oMenus[i].innerHTML,s_SubID,1,i);height+=20;}else{liLine=1;if(oMenus[i].lineNumber!=null&&oMenus[i].lineNumber!=""){liLine=oMenus[i].lineNumber-0;}lsLineName="";if(oMenus[i].lineName!=null&&oMenus[i].lineName!=""){lsLineName=oMenus[i].lineName;}lsLine="";for(var j=0;j<liLine;j++){lsLine+=sLine;}liLineHeight=liLine*2;if(lsLineName!=""&&liLineHeight<18){liLineHeight=18;}sMenu+=ReplaceSubstring_(ReplaceSubstring_(ReplaceSubstring_(sMenuHr,"{NAME}",lsLineName),"{LINEHEIGHT}",liLineHeight),"{LINE}",lsLine);height+=liLineHeight;}}}height+=2;if(sMenu==""){return false;}if(pbRightClick==true){var left=event.clientX;var top=event.clientY;}else{if(event.srcElement.tagName=="A"){var left=getLeftPosi();var top=getTopPosi();}else{var left=event.clientX-event.offsetX-2;var top=event.clientY-event.offsetY+22;}}if(left+width>document.body.clientWidth){left=document.body.clientWidth-width;}var sDiv1="",sDiv2="";if(height>document.body.clientHeight){sDiv1=sScrollDiv1;sDiv2=sScrollDiv2;height=document.body.clientHeight;}var sMenuHeader='<head><link href="menu.css" type="text/css" rel="stylesheet"><script>function getTopPosi(){var obj = event.srcElement;var liTop=obj.offsetTop; while(obj=obj.offsetParent){liTop += obj.offsetTop;} if (typeof(document.all.menuDiv)=="object") liTop = liTop-document.all.menuDiv.scrollTop; return liTop;}<\/script></head><body scroll="no" onselectstart="return false" onConTextMenu="event.returnValue=false;">';var sMenu1="<TABLE border=0 cellpadding=0 cellspacing=0 class=Menu initWidth='"+initWidth+"' width='"+width+"' left='"+left+"' leftInterval='"+(event.screenX-event.clientX)+"' topInterval='"+(event.screenY-event.clientY-26)+"' iframe='"+iframe+"' id=menuContainer>";var sMenu2="</TABLE>";sMenu=sDiv1+sMenu1+sMenu+sMenu2+sDiv2;oPopupSubMenu.hide();oPopupThirdMenu.hide();oPopDocument.open();oPopDocument.write(sMenuHeader+sMenu);oPopDocument.close();oPopupSubMenu=oPopupMenu.document.parentWindow.createPopup();oPopupThirdMenu=oPopupSubMenu.document.parentWindow.createPopup();oPopupMenu.show(left,top,width,height,document.body);return false;}function showSubMenu(name,top){var sMenuHr="<tr><td class=LeftBg nowrap width=22></td><td align=center valign=Middle height={LINEHEIGHT} colspan=2 class=MouseOut><TABLE border=0 cellpadding=0 cellspacing=0 width=98% height={LINEHEIGHT}><tr><td width=50% valign=middle>{LINE}</td><td nowrap disabled valign=middle>{NAME}</td><td width=50% valign=middle>{LINE}</td></tr></TABLE></td></tr>";var sLine="<TABLE border=0 cellpadding=0 cellspacing=0 width=100% height=2><tr><td height=1 class=HrShadow></td></tr><tr><td height=1 class=HrHighLight></td></tr></TABLE>";var sScrollDiv1='<script>var goTime=null;function UpDown(arrow,auto){if(arrow=="up"){document.all.menuDiv.scrollTop -=20;}else if(arrow=="down"){document.all.menuDiv.scrollTop +=20;} if(auto==true){goTime = setTimeout("UpDown(\'"+arrow+"\',true);", 150);}}<\/script>';sScrollDiv1+='<table cellpadding=0 cellspacing=0 class=Menu style="width:100%;height:100%">';sScrollDiv1+='<tr><td height=10 align=center class=MouseOut style="CURSOR: hand" onDblClick="UpDown(\'up\',false);" onMouseDown="UpDown(\'up\',true);" onMouseUp="clearTimeout(goTime);"><font style=\'font-family:Webdings\'>5</font></td></tr>';sScrollDiv1+='<tr><td style="vertical-align:top;">';sScrollDiv1+='<div id=menuDiv style="position:absolute;width:100%;height:100%;overflow-x:hidden;overflow-y:hidden;border:0px solid #000000;clip:rect();">';var sScrollDiv2="</div></td></tr>";sScrollDiv2+='<tr><td height=10 align=center class=MouseOut style="CURSOR: hand" onDblClick="UpDown(\'down\',false);" onMouseDown="UpDown(\'down\',true);" onMouseUp="clearTimeout(goTime);"><font style=\'font-family:Webdings\'>6</font></td></tr></table>';var oPopDocument=oPopupSubMenu.document;var oPopBody=oPopupSubMenu.document.body;var mainLeft=oPopupMenu.document.all.menuContainer.left-0;var iframe=oPopupMenu.document.all.menuContainer.iframe;var parentWidth=oPopupMenu.document.all.menuContainer.width-0;var initWidth=oPopupMenu.document.all.menuContainer.initWidth-0;top-=oPopupMenu.document.all.menuContainer.topInterval-0;var left=parentWidth;var sMenuHeader='<head><link href="menu.css" type="text/css" rel="stylesheet"><script>function getTopPosi(){var obj = event.srcElement;var liTop=obj.offsetTop; while(obj=obj.offsetParent){liTop += obj.offsetTop;} if (typeof(document.all.menuDiv)=="object") liTop = liTop-document.all.menuDiv.scrollTop; return liTop;}<\/script></head><body scroll="no" onselectstart="return false" onConTextMenu="event.returnValue=false;">';var sMenu="";var height=0;var s_Disabled="";var s_event="";var s_SubID="";var liLine=1,liLineHeight=0,lsLine="",lsLineName="",loMenus=null,liWidth=0,liThirdWidth=0;var lodoc=eval(iframe+".document");var oMenus=lodoc.getElementsByName(name);if(oMenus!=null){var width=iGetFontLength(oMenus,initWidth);for(var i=0;i<oMenus.length;i++){if(oMenus[i].imgName!="HR"){if(oMenus[i].thirdMenuID!=null&&oMenus[i].thirdMenuID!=""){s_SubID=oMenus[i].thirdMenuID;loMenus=lodoc.getElementsByName(s_SubID);if(loMenus!=null&&loMenus.length>0){liWidth=iGetFontLength(loMenus,initWidth);liThirdWidth=(liWidth>liThirdWidth)?liWidth:liThirdWidth;}}else{s_SubID="";}s_event="";if(oMenus[i].onclick!=null){s_event=iframe+".document.getElementsByName('"+name+"')["+i+"].click()";}s_Disabled="";if(oMenus[i].disabled==true){s_Disabled="disabled";}sMenu+=getMenuRow(s_Disabled,s_event,oMenus[i].imgName,oMenus[i].innerHTML,s_SubID,2,i);height+=20;}else{liLine=1;if(oMenus[i].lineNumber!=null&&oMenus[i].lineNumber!=""){liLine=oMenus[i].lineNumber-0;}lsLineName="";if(oMenus[i].lineName!=null&&oMenus[i].lineName!=""){lsLineName=oMenus[i].lineName;}lsLine="";for(var j=0;j<liLine;j++){lsLine+=sLine;}liLineHeight=liLine*2;if(lsLineName!=""&&liLineHeight<18){liLineHeight=18;}sMenu+=ReplaceSubstring_(ReplaceSubstring_(ReplaceSubstring_(sMenuHr,"{NAME}",lsLineName),"{LINEHEIGHT}",liLineHeight),"{LINE}",lsLine);height+=liLineHeight;}}}height+=2;if(sMenu==""){return false;}if(left+mainLeft+width+liThirdWidth>document.body.clientWidth){left=left-parentWidth-width;}var sDiv1="",sDiv2="";if(height>document.body.clientHeight){sDiv1=sScrollDiv1;sDiv2=sScrollDiv2;height=document.body.clientHeight;}var sMenu1="<TABLE border=0 cellpadding=0 cellspacing=0 class=Menu width='"+width+"' id=menuContainer>";var sMenu2="</TABLE>";sMenu=sDiv1+sMenu1+sMenu+sMenu2+sDiv2;oPopupThirdMenu.hide();oPopDocument.open();oPopDocument.write(sMenuHeader+sMenu);oPopDocument.close();oPopupThirdMenu=oPopupSubMenu.document.parentWindow.createPopup();left-=oPopupMenu.document.all.menuContainer.leftInterval-0;oPopupSubMenu.show(left,top,width,height,document.body);return false;}function showThirdMenu(name,top){var sMenuHr="<tr><td class=LeftBg nowrap width=22></td><td align=center valign=Middle height={LINEHEIGHT} colspan=2 class=MouseOut><TABLE border=0 cellpadding=0 cellspacing=0 width=98% height={LINEHEIGHT}><tr><td width=50% valign=middle>{LINE}</td><td nowrap disabled valign=middle>{NAME}</td><td width=50% valign=middle>{LINE}</td></tr></TABLE></td></tr>";var sLine="<TABLE border=0 cellpadding=0 cellspacing=0 width=100% height=2><tr><td height=1 class=HrShadow></td></tr><tr><td height=1 class=HrHighLight></td></tr></TABLE>";var sScrollDiv1='<script>var goTime=null;function UpDown(arrow,auto){if(arrow=="up"){document.all.menuDiv.scrollTop -=20;}else if(arrow=="down"){document.all.menuDiv.scrollTop +=20;} if(auto==true){goTime = setTimeout("UpDown(\'"+arrow+"\',true);", 150);}}<\/script>';sScrollDiv1+='<table cellpadding=0 cellspacing=0 class=Menu style="width:100%;height:100%">';sScrollDiv1+='<tr><td height=10 align=center class=MouseOut style="CURSOR: hand" onDblClick="UpDown(\'up\',false);" onMouseDown="UpDown(\'up\',true);" onMouseUp="clearTimeout(goTime);"><font style=\'font-family:Webdings\'>5</font></td></tr>';sScrollDiv1+='<tr><td style="vertical-align:top;">';sScrollDiv1+='<div id=menuDiv style="position:absolute;width:100%;height:100%;overflow-x:hidden;overflow-y:hidden;border:0px solid #000000;clip:rect();">';var sScrollDiv2="</div></td></tr>";sScrollDiv2+='<tr><td height=10 align=center class=MouseOut style="CURSOR: hand" onDblClick="UpDown(\'down\',false);" onMouseDown="UpDown(\'down\',true);" onMouseUp="clearTimeout(goTime);"><font style=\'font-family:Webdings\'>6</font></td></tr></table>';var oPopDocument=oPopupThirdMenu.document;var oPopBody=oPopupThirdMenu.document.body;var mainLeft=oPopupMenu.document.all.menuContainer.left-0;var iframe=oPopupMenu.document.all.menuContainer.iframe;var mainWidth=oPopupMenu.document.all.menuContainer.width-0;var parentWidth=oPopupSubMenu.document.all.menuContainer.width-0;var initWidth=oPopupMenu.document.all.menuContainer.initWidth-0;top-=oPopupMenu.document.all.menuContainer.topInterval-0;var left=parentWidth;var sMenuHeader='<head><link href="menu.css" type="text/css" rel="stylesheet"></head><body scroll="no" onselectstart="return false" onConTextMenu="event.returnValue=false;">';var sMenu="";var height=0;var s_Disabled="";var s_event="";var liLine=1,liLineHeight=0,lsLine="",lsLineName="";var lodoc=eval(iframe+".document");var oMenus=lodoc.getElementsByName(name);if(oMenus!=null){var width=iGetFontLength(oMenus,initWidth);for(var i=0;i<oMenus.length;i++){if(oMenus[i].imgName!="HR"){s_event="";if(oMenus[i].onclick!=null){s_event=iframe+".document.getElementsByName('"+name+"')["+i+"].click()";}s_Disabled="";if(oMenus[i].disabled==true){s_Disabled="disabled";}sMenu+=getMenuRow(s_Disabled,s_event,oMenus[i].imgName,oMenus[i].innerHTML,"",3,i);height+=20;}else{liLine=1;if(oMenus[i].lineNumber!=null&&oMenus[i].lineNumber!=""){liLine=oMenus[i].lineNumber-0;}lsLineName="";if(oMenus[i].lineName!=null&&oMenus[i].lineName!=""){lsLineName=oMenus[i].lineName;}lsLine="";for(var j=0;j<liLine;j++){lsLine+=sLine;}liLineHeight=liLine*2;if(lsLineName!=""&&liLineHeight<18){liLineHeight=18;}sMenu+=ReplaceSubstring_(ReplaceSubstring_(ReplaceSubstring_(sMenuHr,"{NAME}",lsLineName),"{LINEHEIGHT}",liLineHeight),"{LINE}",lsLine);height+=liLineHeight;}}}height+=2;if(sMenu==""){return false;}if(mainLeft+mainWidth+parentWidth+width>document.body.clientWidth){left=mainWidth-parentWidth-width;}var sDiv1="",sDiv2="";if(height>document.body.clientHeight){sDiv1=sScrollDiv1;sDiv2=sScrollDiv2;height=document.body.clientHeight;}var sMenu1="<TABLE border=0 cellpadding=0 cellspacing=0 class=Menu width='"+width+"'>";var sMenu2="</TABLE>";sMenu=sDiv1+sMenu1+sMenu+sMenu2+sDiv2;oPopDocument.open();oPopDocument.write(sMenuHeader+sMenu);oPopDocument.close();left-=oPopupMenu.document.all.menuContainer.leftInterval-0;oPopupThirdMenu.show(left,top,width,height,document.body);return false;}function getLeftPosi(){var obj=event.srcElement;var liLeft=obj.offsetLeft;while(obj=obj.offsetParent){liLeft+=obj.offsetLeft;}return liLeft-document.body.scrollLeft;}function getTopPosi(){var obj=event.srcElement;var liTop=obj.offsetTop+obj.offsetHeight;while(obj=obj.offsetParent){liTop+=obj.offsetTop;}return liTop-document.body.scrollTop;}function ReplaceSubstring_(psSource,psFrom,psTo){var lpos=0;var lsReturn="";while(psSource.indexOf(psFrom)>-1){lpos=psSource.indexOf(psFrom);lsReturn+=psSource.substring(0,lpos)+psTo;psSource=psSource.substring((lpos+psFrom.length),psSource.length);}lsReturn+=psSource;if(lsReturn.substring(lsReturn.length-psFrom.length,lsReturn.length)==" "+psFrom.substring(0,psFrom.length-1)){lsReturn=""+lsReturn.substring(0,lsReturn.length-psFrom.length+1)+psTo.substring(0,psTo.length-1);}return lsReturn;}